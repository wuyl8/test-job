<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="TimedTask">
	
	<insert id="insertOfferStatistics" parameterType="map">
			insert into OFFER_STATISTICS_INFO
			  (OFFER_STATISTICS_INFO_ID,
			   ACCT_PERIOD,
			   LATN_ID,
			   LATN_NAME,
			   OFFER_ID,
			   OFFER_NAME,
			   OFFER_TYPE,
			   OFFER_ARRIVAL_NUM,
			   USER_ARRIVAL_NUM,
			   OFFER_GROWTH_NUM,
			   OFFER_NEW_ORDERS,
			   OFFER_CHANGE_NUM,
			   OFFER_MOVE_NUM,
			   OFFER_OFF_NUM,
			   OFFER_ALL_INCOME,
			   NEW_CUR_ARPU,
			   CHANGE_CUR_ARPU,
			   CHANGE_LAST_MONTN_ARPU,
			   OFFER_TRAFFIC,
			   OFFER_FLOW,
			   OFFER_MOU,
			   OFFER_DOU,
			   ONE_MONTH_ORDERS,
			   USERS_AMOUNT,
			   THREE_MONTH_ORDERS,
			   SIX_MONTH_ORDERS,
			   TWELVE_MONTH_ORDERS,
			   
			   C_ONE_MONTH_ORDERS,
			   C_THREE_MONTH_ORDERS,
			   C_SIX_MONTH_ORDERS,
			   C_TWELVE_MONTH_ORDERS,
			   
			   CREATE_DATE,
			   
			   CREATE_STAFF, 
			   UPDATE_DATE,
			   UPDATE_STAFF,
			   
			   REMARK,
			   
			    C_ONE_MONTH_ORDERS_ST, C_THREE_MONTH_ORDERS_ST,
				C_SIX_MONTH_ORDERS_ST, C_TWELVE_MONTH_ORDERS_ST,
				C_ONE_MONTH_ORDERS_DZ,
				C_THREE_MONTH_ORDERS_DZ, C_SIX_MONTH_ORDERS_DZ,
				C_TWELVE_MONTH_ORDERS_DZ, C_ONE_MONTH_ORDERS_ZX,
				C_THREE_MONTH_ORDERS_ZX, C_SIX_MONTH_ORDERS_ZX,
				C_TWELVE_MONTH_ORDERS_ZX,
				AVG_MOBCARD_NUM, AVG_ACTIVE_MOBCARD_NUM,
				AVG_BB_NUM,
				AVG_ACTIVE_BB_NUM, AVG_NETITV_NUM, AVG_ACTIVE_NATITV_NUM,
				MOB_ARRIVAL, MOB_MAINCARD_ARRIVAL, MOB_GROWTH,
				MOB_MAINCARD_GROWTH,
				ADD_MOB_NUM, MOB_ADD,
				MOB_MAINCARD_ADD, MOB_INCOME, MOB_ARPU,
				MOB_DOU,
				MOB_MOU, MOB_LOST_USERS,
				BB_BILLING_ARRIVAL, BB_BILLING_GROWTH,
				BB_ADD_NUM,
				BB_ADD, BB_FIRST_ADD, BB_SECOND_ADD,
				BB_ACTIVE_USER,
				BB_INCOME, BB_ARPU,
				IPTV_ADD_NUM, IPTV_ADD_INSTALL, IPTV_ADD_HD,
				IPTV_ADD_SD, IPTV_ARRIVAL, IPTV_ARRIVAL_HD,
				IPTV_ARRIVAL_SD,
				IPTV_GROWTH, IPTV_GROWTH_HD,
				IPTV_GROWTH_SD, IPTV_TEARDOWN_NUM,
				ARREAR_LOST_NUM,
				TOTAL_WATCH_NUM
			   )
			VALUES
			  (SEQ_OFFER_STATISTICS_INFO.nextval,
			   #{ACCT_PERIOD},
			   #{LATN_ID},
			   #{LATN_NAME},
			   #{OFFER_ID},
			   #{OFFER_NAME},
			   #{OFFER_TYPE},
			   #{OFFER_ARRIVAL_NUM},
			   #{USER_ARRIVAL_NUM},
			   #{OFFER_GROWTH_NUM},
			   #{OFFER_NEW_ORDERS},
			   #{OFFER_CHANGE_NUM},
			   #{OFFER_MOVE_NUM},
			   #{OFFER_OFF_NUM},
			   #{OFFER_ALL_INCOME},
			   #{NEW_CUR_ARPU},
			   #{CHANGE_CUR_ARPU},
			   #{CHANGE_LAST_MONTN_ARPU},
			   #{OFFER_TRAFFIC},
			   #{OFFER_FLOW},
			   #{OFFER_MOU},
			   #{OFFER_DOU},
			   #{ONE_MONTH_ORDERS},
			   #{USERS_AMOUNT},
			   #{THREE_MONTH_ORDERS},
			   #{SIX_MONTH_ORDERS},
			   #{TWELVE_MONTH_ORDERS},
				#{C_ONE_MONTH_ORDERS},
				#{C_THREE_MONTH_ORDERS},
				#{C_SIX_MONTH_ORDERS},
				#{C_TWELVE_MONTH_ORDERS},			   
			   now(),
			   	#{CREATE_STAFF},
				now(),
				#{UPDATE_STAFF},
			   
			   '定时任务插入',
			   
			   	#{C_ONE_MONTH_ORDERS_ST},
				#{C_THREE_MONTH_ORDERS_ST},
				#{C_SIX_MONTH_ORDERS_ST},
				#{C_TWELVE_MONTH_ORDERS_ST},
				#{C_ONE_MONTH_ORDERS_DZ},
				#{C_THREE_MONTH_ORDERS_DZ},
				#{C_SIX_MONTH_ORDERS_DZ},
				#{C_TWELVE_MONTH_ORDERS_DZ},
				#{C_ONE_MONTH_ORDERS_ZX},
				#{C_THREE_MONTH_ORDERS_ZX},
				#{C_SIX_MONTH_ORDERS_ZX},
				#{C_TWELVE_MONTH_ORDERS_ZX},
				#{AVG_MOBCARD_NUM},
				#{AVG_ACTIVE_MOBCARD_NUM}, #{AVG_BB_NUM},
				#{AVG_ACTIVE_BB_NUM}, #{AVG_NETITV_NUM},
				#{AVG_ACTIVE_NATITV_NUM},
				#{MOB_ARRIVAL},
				#{MOB_MAINCARD_ARRIVAL}, #{MOB_GROWTH},
				#{MOB_MAINCARD_GROWTH}, #{ADD_MOB_NUM},
				#{MOB_ADD},
				#{MOB_MAINCARD_ADD},
				#{MOB_INCOME}, #{MOB_ARPU},
				#{MOB_DOU}, #{MOB_MOU},
				#{MOB_LOST_USERS},
				#{BB_BILLING_ARRIVAL},
				#{BB_BILLING_GROWTH}, #{BB_ADD_NUM},
				#{BB_ADD}, #{BB_FIRST_ADD},
				#{BB_SECOND_ADD},
				#{BB_ACTIVE_USER},
				#{BB_INCOME}, #{BB_ARPU},
				#{IPTV_ADD_NUM}, #{IPTV_ADD_INSTALL},
				#{IPTV_ADD_HD},
				#{IPTV_ADD_SD},
				#{IPTV_ARRIVAL}, #{IPTV_ARRIVAL_HD},
				#{IPTV_ARRIVAL_SD}, #{IPTV_GROWTH},
				#{IPTV_GROWTH_HD},
				#{IPTV_GROWTH_SD},
				#{IPTV_TEARDOWN_NUM}, #{ARREAR_LOST_NUM},
				#{TOTAL_WATCH_NUM}
			   
			   )
	</insert>
	
	
	<insert id="insertOfferStatisticsOnce" parameterType="map">
insert into offer_statistics_once 
		(OFFER_STATISTICS_ONCE_ID,
		LATN_ID,
		LATN_NAME,
		OFFER_ID, OFFER_NAME, OFFER_TYPE,
		OFFER_ARRIVAL_NUM,
		USER_ARRIVAL_NUM, OFFER_GROWTH_NUM,
		OFFER_NEW_ORDERS, OFFER_CHANGE_NUM,
		OFFER_MOVE_NUM,
		OFFER_OFF_NUM, OFFER_ALL_INCOME, NEW_CUR_ARPU,
		CHANGE_CUR_ARPU, CHANGE_LAST_MONTN_ARPU, OFFER_TRAFFIC,
		OFFER_FLOW,
		OFFER_MOU, OFFER_DOU,
		ONE_MONTH_ORDERS, USERS_AMOUNT,
		THREE_MONTH_ORDERS,
		SIX_MONTH_ORDERS, TWELVE_MONTH_ORDERS,
		C_ONE_MONTH_ORDERS,
		C_THREE_MONTH_ORDERS, C_SIX_MONTH_ORDERS,
		C_TWELVE_MONTH_ORDERS,
		CREATE_DATE, CREATE_STAFF, UPDATE_DATE,
		UPDATE_STAFF, REMARK,
		
		C_ONE_MONTH_ORDERS_ST,
		C_THREE_MONTH_ORDERS_ST,
		C_SIX_MONTH_ORDERS_ST, C_TWELVE_MONTH_ORDERS_ST,
		C_ONE_MONTH_ORDERS_DZ, C_THREE_MONTH_ORDERS_DZ, C_SIX_MONTH_ORDERS_DZ,
		C_TWELVE_MONTH_ORDERS_DZ, C_ONE_MONTH_ORDERS_ZX,
		C_THREE_MONTH_ORDERS_ZX, C_SIX_MONTH_ORDERS_ZX,
		C_TWELVE_MONTH_ORDERS_ZX,
		AVG_MOBCARD_NUM, AVG_ACTIVE_MOBCARD_NUM,
		AVG_BB_NUM,
		AVG_ACTIVE_BB_NUM, AVG_NETITV_NUM, AVG_ACTIVE_NATITV_NUM,
		MOB_ARRIVAL, MOB_MAINCARD_ARRIVAL, MOB_GROWTH,
		MOB_MAINCARD_GROWTH,
		ADD_MOB_NUM, MOB_ADD,
		MOB_MAINCARD_ADD, MOB_INCOME, MOB_ARPU,
		MOB_DOU,
		MOB_MOU, MOB_LOST_USERS,
		BB_BILLING_ARRIVAL, BB_BILLING_GROWTH,
		BB_ADD_NUM,
		BB_ADD, BB_FIRST_ADD, BB_SECOND_ADD,
		BB_ACTIVE_USER,
		BB_INCOME, BB_ARPU,
		IPTV_ADD_NUM, IPTV_ADD_INSTALL, IPTV_ADD_HD,
		IPTV_ADD_SD, IPTV_ARRIVAL, IPTV_ARRIVAL_HD,
		IPTV_ARRIVAL_SD,
		IPTV_GROWTH, IPTV_GROWTH_HD,
		IPTV_GROWTH_SD, IPTV_TEARDOWN_NUM,
		ARREAR_LOST_NUM,
		TOTAL_WATCH_NUM, USER_AMOUNT_BYEAR, USER_ARRIVAL_BYEAR
		)
		values (SEQ_OFFER_STATISTICS_INFO.nextval,
		#{LATN_ID},
		#{LATN_NAME},
		#{OFFER_ID}, #{OFFER_NAME},
		#{OFFER_TYPE},
		#{OFFER_ARRIVAL_NUM},
		#{USER_ARRIVAL_NUM},
		#{OFFER_GROWTH_NUM},
		#{OFFER_NEW_ORDERS}, #{OFFER_CHANGE_NUM},
		#{OFFER_MOVE_NUM},
		#{OFFER_OFF_NUM},
		#{OFFER_ALL_INCOME},
		#{NEW_CUR_ARPU},
		#{CHANGE_CUR_ARPU},
		#{CHANGE_LAST_MONTN_ARPU},
		#{OFFER_TRAFFIC},
		#{OFFER_FLOW},
		#{OFFER_MOU}, #{OFFER_DOU},
		#{ONE_MONTH_ORDERS}, #{USERS_AMOUNT},
		#{THREE_MONTH_ORDERS},
		#{SIX_MONTH_ORDERS},
		#{TWELVE_MONTH_ORDERS},
		#{C_ONE_MONTH_ORDERS},
		#{C_THREE_MONTH_ORDERS},
		#{C_SIX_MONTH_ORDERS},
		#{C_TWELVE_MONTH_ORDERS},
		NOW(), #{CREATE_STAFF},
		NOW(),
		#{UPDATE_STAFF},
		'定时任务插入', #{C_ONE_MONTH_ORDERS_ST},
		#{C_THREE_MONTH_ORDERS_ST},
		#{C_SIX_MONTH_ORDERS_ST},
		#{C_TWELVE_MONTH_ORDERS_ST},
		#{C_ONE_MONTH_ORDERS_DZ},
		#{C_THREE_MONTH_ORDERS_DZ},
		#{C_SIX_MONTH_ORDERS_DZ},
		#{C_TWELVE_MONTH_ORDERS_DZ},
		#{C_ONE_MONTH_ORDERS_ZX},
		#{C_THREE_MONTH_ORDERS_ZX},
		#{C_SIX_MONTH_ORDERS_ZX},
		#{C_TWELVE_MONTH_ORDERS_ZX},
		#{AVG_MOBCARD_NUM},
		#{AVG_ACTIVE_MOBCARD_NUM}, #{AVG_BB_NUM},
		#{AVG_ACTIVE_BB_NUM}, #{AVG_NETITV_NUM},
		#{AVG_ACTIVE_NATITV_NUM},
		#{MOB_ARRIVAL},
		#{MOB_MAINCARD_ARRIVAL}, #{MOB_GROWTH},
		#{MOB_MAINCARD_GROWTH}, #{ADD_MOB_NUM},
		#{MOB_ADD},
		#{MOB_MAINCARD_ADD},
		#{MOB_INCOME}, #{MOB_ARPU},
		#{MOB_DOU}, #{MOB_MOU},
		#{MOB_LOST_USERS},
		#{BB_BILLING_ARRIVAL},
		#{BB_BILLING_GROWTH}, #{BB_ADD_NUM},
		#{BB_ADD}, #{BB_FIRST_ADD},
		#{BB_SECOND_ADD},
		#{BB_ACTIVE_USER},
		#{BB_INCOME}, #{BB_ARPU},
		#{IPTV_ADD_NUM}, #{IPTV_ADD_INSTALL},
		#{IPTV_ADD_HD},
		#{IPTV_ADD_SD},
		#{IPTV_ARRIVAL}, #{IPTV_ARRIVAL_HD},
		#{IPTV_ARRIVAL_SD}, #{IPTV_GROWTH},
		#{IPTV_GROWTH_HD},
		#{IPTV_GROWTH_SD},
		#{IPTV_TEARDOWN_NUM}, #{ARREAR_LOST_NUM},
		#{TOTAL_WATCH_NUM}, #{USER_AMOUNT_BYEAR},
		#{USER_ARRIVAL_BYEAR}
		)
	</insert>
	
	<delete id="delOfferStatisticsOnce">
		delete from offer_statistics_once where 1=1
	</delete>
	
	<select id="sumUserAmountByear" resultType="java.lang.String">
		select sum(OFFER_STATISTICS_INFO.USERS_AMOUNT) from OFFER_STATISTICS_INFO where latn_id=888
	</select>
	
	<select id="sumUserArrivalByear" resultType="java.lang.String">
		select sum(OFFER_STATISTICS_INFO.USER_ARRIVAL_NUM) from OFFER_STATISTICS_INFO where latn_id=888
	</select>
	
	<update id="updateOfferStatisticsOnce" parameterType="map">
		update offer_statistics_once set USER_AMOUNT_BYEAR = #{USER_AMOUNT_BYEAR},USER_ARRIVAL_BYEAR=#{USER_ARRIVAL_BYEAR}
		where 1=1
	</update>
</mapper> 
